

--// CONSULTA TITULO  

SELECT E1.E1_SITUACA, E1.E1_NUMBCO ,E1_FILIAL,E1_NUM, E1_PARCELA , E1.E1_CLIENTE,A1_CGC, E1_CONTA , E1_CONTRAT, E1_PORTADO, E1_VALOR, E1_NOMCLI, E1_EMISSAO, E1.E1_DATABOR , E1_VENCTO, E1_NUMBOR, E1.E1_DATABOR
FROM SE1020 E1
INNER JOIN SA1010 ON A1_COD = E1_CLIENTE AND A1_LOJA = E1_LOJA
WHERE  E1_EMISSAO  > '20200101'
AND E1_NUM = '000172622'
--AND E1.D_E_L_E_T_ <> '*'
--AND E1_PORTADO <> ''
--AND E1_BAIXA = ''
--AND E1_VENCTO = '20200706'
--AND A1_CGC = '69666873672'
--AND E1_NUMBOR  = 'T0EJGA'
--AND E1_FILIAL = '06'
--AND E1_CONTA LIKE '%020362983%'
--AND E1.E1_NUMBCO like '%32529306000001414%'  
--AND E1.E1_PREFIXO = '1  '
--AND E1.E1_BAIXA = ''


-- /// VERIFICA BORDERO DO DIA NO MERCANTIL 
DECLARE @EMIINI DATE 
SET @EMIINI	 = '20200731' 
SELECT
E1_FILIAL,
E1_PORTADO,
E1_CONTA,
E1_CONTRAT,
E1_NUMBOR,
COUNT(E1_NUM)
FROM SE1050
WHERE
D_E_L_E_T_ = ''
AND E1_DATABOR = @EMIINI
AND E1_SITUACA <>'0'
AND E1_PORTADO = '001'
GROUP BY 
E1_FILIAL,
E1_PORTADO,
E1_CONTA,
E1_CONTRAT,
E1_NUMBOR
ORDER BY 
E1_FILIAL,
E1_PORTADO,
E1_CONTA,
E1_CONTRAT,
E1_NUMBOR

-- /// VERIFICA BORDERO DO DIA NO MERCANTIL POR TITULO 
SELECT 
E1_FILIAL,
E1_PORTADO,
E1_CONTA,
E1_CONTRAT,
E1_NUMBOR,
E1_NUMBCO,
E1_NOMCLI,
E1_NUM,
E1_VENCTO,
E1_DATABOR,
E1_VALOR
FROM SE1010 WHERE E1_DATABOR = '20200825'
AND D_E_L_E_T_ <> '*'
AND E1_PORTADO = '389'
--AND E1_CONTA = '020161781 '
--AND E1_FILIAL = '03'
ORDER BY 
E1_NOMCLI,
E1_FILIAL,
E1_PORTADO,
E1_CONTA,
E1_CONTRAT,
E1_NUMBOR,
E1_NUMBCO

-- // CONSULTA SE TODOS OS BORDEROS QUE NÃO FORAM  GERADOS 
SELECT EA_FILIAL, EA_NUMBOR, EA_NUMCON , EA_AGEDEP,EA_PORTADO,  COUNT(EA_NUM) AS QTD FROM SEA010     
WHERE EA_DATABOR BETWEEN  '20200811' AND '20200819'  -- <----- DATA AQUI
--AND EA_PORTADO = '389'  
AND EA_TRANSF = ''  
AND EA_CART = 'R'  
AND D_E_L_E_T_ <> '*'
GROUP BY EA_FILIAL, EA_NUMBOR, EA_NUMCON, EA_AGEDEP,EA_PORTADO  
ORDER BY EA_FILIAL, EA_NUMCON,EA_NUMBOR, EA_AGEDEP,EA_PORTADO

SELECT * FROM SEA010 WHERE EA_DATABOR = '20200805' AND  EA_TRANSF = ''  AND D_E_L_E_T_ = ''

UPDATE SEA050 SET EA_DATABOR = '20200806' WHERE EA_DATABOR = '20200805' AND  EA_TRANSF = ''  AND D_E_L_E_T_ = ''
 



--// VERIFICA NA EMPRESA SE EXISTE BOELTO SEM CAUCAO
DECLARE @EMIINI DATE 
SET @EMIINI = '20200731'  --<--------  AQUI TROCA A DATA -----<-----
SELECT EMP,E1_FILIAL,E1_NUM,E1_VALOR,E1_CLIENTE,E1_NOMCLI,E1_EMISSAO,E1_VENCTO,E1_PORTADO,E1_NUMBCO,E1_CONTA,E1_AGEDEP,E1_CONTRAT, RESP_GXML, NFE_ID, DATE_NFE, ID_ENT, TIME_NFE
FROM (	
	SELECT '01DIST' AS EMP,E1_FILIAL,E1_NUM,E1_VALOR,E1_CLIENTE,E1_NOMCLI,E1_EMISSAO,E1_VENCTO,E1_PORTADO,E1_NUMBCO,E1_CONTA,E1_AGEDEP,E1_CONTRAT 
	FROM SE1010
	WHERE E1_EMISSAO = @EMIINI    
	AND E1_EMISSAO <> E1_VENCTO
	AND E1_PORTADO = ''
	AND E1_PREFIXO = '1'
	AND SE1010.D_E_L_E_T_ <> '*'
	UNION
	SELECT '02DERI' AS EMP,E1_FILIAL,E1_NUM,E1_VALOR,E1_CLIENTE,E1_NOMCLI,E1_EMISSAO,E1_VENCTO,E1_PORTADO,E1_NUMBCO,E1_CONTA,E1_AGEDEP,E1_CONTRAT
	FROM SE1020
	WHERE E1_EMISSAO = @EMIINI    
	AND E1_EMISSAO <> E1_VENCTO
	AND E1_PORTADO = ''
	AND E1_PREFIXO = '1'
	AND SE1020.D_E_L_E_T_ <> '*' 
	UNION
	SELECT '05TRRG' AS EMP,E1_FILIAL,E1_NUM,E1_VALOR,E1_CLIENTE,E1_NOMCLI,E1_EMISSAO,E1_VENCTO,E1_PORTADO,E1_NUMBCO,E1_CONTA,E1_AGEDEP,E1_CONTRAT
	FROM SE1050
	WHERE E1_EMISSAO = @EMIINI    
	AND E1_EMISSAO <> E1_VENCTO
	AND E1_PORTADO = ''
	AND E1_PREFIXO = '1'
	AND SE1050.D_E_L_E_T_ <> '*'
) AS SEMCAU 
INNER JOIN SPED050 ON '1  '+E1_NUM = NFE_ID  AND DATE_NFE = E1_EMISSAO AND SPED050.D_E_L_E_T_ <> '*'
WHERE E1_CLIENTE NOT IN ('001773','012176')


--// CONSULTA TITULO / FATURISTA 

SELECT RESP_GXML, *
FROM (
SELECT A3_NOME ,E1_FILIAL,E1_NUM ,A1_CGC, E1_CONTA , E1_CONTRAT, E1_PORTADO, E1_VALOR, E1_NOMCLI, E1_EMISSAO, E1_VENCTO, E1_NUMBOR, E1.E1_DATABOR
FROM SE1020 E1
INNER JOIN SA1010 ON A1_COD = E1_CLIENTE AND A1_LOJA = E1_LOJA
INNER JOIN SA3010 ON A1_VEND = A3_COD
WHERE  E1_EMISSAO  > '20200101'
AND E1.D_E_L_E_T_ <> '*'
AND E1_NUM = '000169175'
--AND E1_PORTADO = '389'
--AND E1_BAIXA = ''
--AND E1_VENCTO = '20200706'
--AND A1_CGC = '69666873672'
--AND E1_NUMBOR  = 'T0EJ3J'
--AND E1_FILIAL = '06'
--AND E1_CONTA LIKE '%020362983%'
) AS SEMCAU2
INNER JOIN SPED050 ON '1  '+E1_NUM = NFE_ID  AND DATE_NFE = E1_EMISSAO AND SPED050.D_E_L_E_T_ <> '*'    


--//////////////////////////////////////////////////////////////////////////////////////////////
--//////////////////////////////////////////////////////////////////////////////////////////////
--###################################################################################

-- /// POSIÇÃO DOS TITULOS NO BANCO ATUAL
DECLARE @EMIINI DATE 
DECLARE @EMIFIM DATE 
SET @EMIINI	 = '20210108'     --<----------- MUDAR AQUI A DATA ATUAL ****************
SET @EMIFIM = '20210108'
SELECT
E1_PORTADO,
CASE
    WHEN E1_CONTA = '0020362983' THEN E1_CONTA+' - CRA'
    WHEN E1_CONTA = '020161781 '  THEN E1_CONTA+' - GRP'
    ELSE E1_CONTA 
END AS E1_CONTA,
E1_CONTRAT,
COUNT(E1_NUM) AS QTD,
SUM(E1_VALOR) AS 'R$'
FROM SE1020                 --<----------- MUDAR AQUI A EMPRESA ****************
WHERE
D_E_L_E_T_ = ''
AND E1_DATABOR BETWEEN @EMIINI AND @EMIFIM
AND E1_SITUACA <>'0'
GROUP BY 
E1_PORTADO,
E1_CONTA,
E1_CONTRAT
ORDER BY 
E1_PORTADO,
E1_CONTA,
E1_CONTRAT



--/////////////////////////////////////////////////////////////////

SELECT E1_NUMBCO, COUNT(E1_NUMBCO) FROM SE1010  -- <- MUDAR A FILIAL
WHERE E1_EMISSAO > '20200901'
AND E1_NUMBCO <> ''
GROUP BY E1_NUMBCO 
HAVING COUNT(E1_NUMBCO)  > 1


SELECT * FROM SE1020 WHERE E1_NUMBCO = '006703020047357'

SELECT * FROM SE1020 WHERE E1_NUM IN (
'000170014',
'000170015')

SELECT DATE_ENFE, TIME_ENFE, RESP_GXML, * FROM SPED050 WHERE NFE_ID IN (
'1  000170014',
'1  000170015')

'000170014'
'000170015'

--////////////////////////////////////////////////////////////
SELECT E1.E1_NUM, REPETIDO.E1_NUMBCO FROM  (
	SELECT E1_CONTA, E1_CONTRAT, E1_NUMBCO, Count(*) FROM SE1020 WHERE 
	E1_PORTADO = '389'
	AND E1_EMISSAO > '20200801'
	AND D_E_L_E_T_ <> '*' 
	GROUP BY E1_CONTA, E1_CONTRAT,E1_NUMBCO HAVING Count(*) > 1 
	) AS REPETIDO
	INNER JOIN SE1020 E1 ON E1.E1_NUMBCO = REPETIDO.E1_NUMBCO   
	ORDER BY REPETIDO.E1_NUMBCO

SELECT * FROM SEA010 WHERE --EA_NUM = '000169549'
EA_DATABOR =  '20200817'   
AND EA_PORTADO = '001'		
AND EA_FILIAL = '06'

SELECT * FROM SE1010 WHERE 



 SELECT * FROM ( 	 
 	SELECT '01' AS EMP , EA_FILIAL, EA_NUMBOR, EA_NUMCON, EA_AGEDEP,EA_PORTADO,  COUNT(EA_NUM) AS QTD 	 FROM SEA010 EA 	 WHERE EA_DATABOR BETWEEN  '20200901'  AND '20201021' 	 AND EA_TRANSF = ''     AND EA_CART = 'R'     AND D_E_L_E_T_ <> '*' 	 GROUP BY EA_FILIAL, EA_NUMBOR, EA_NUMCON, EA_AGEDEP,EA_PORTADO 	 UNION  	 
 	SELECT '02' AS EMP , EA_FILIAL, EA_NUMBOR, EA_NUMCON, EA_AGEDEP,EA_PORTADO,  COUNT(EA_NUM) AS QTD 	 FROM SEA020 EA 	 WHERE EA_DATABOR BETWEEN  '20200901'  AND '20201021' 	 AND EA_TRANSF = ''     AND EA_CART = 'R'     AND D_E_L_E_T_ <> '*' 	 GROUP BY EA_FILIAL, EA_NUMBOR, EA_NUMCON, EA_AGEDEP,EA_PORTADO 	 UNION 	 
 	SELECT '05' AS EMP , EA_FILIAL, EA_NUMBOR, EA_NUMCON, EA_AGEDEP,EA_PORTADO,  COUNT(EA_NUM) AS QTD 	 FROM SEA050 EA 	 WHERE EA_DATABOR BETWEEN  '20200901'  AND '20201021' 	 AND EA_TRANSF = ''     AND EA_CART = 'R'     AND D_E_L_E_T_ <> '*' 	 GROUP BY EA_FILIAL, EA_NUMBOR, EA_NUMCON, EA_AGEDEP,EA_PORTADO 	 UNION  	 
 	SELECT '07' AS EMP , EA_FILIAL, EA_NUMBOR, EA_NUMCON, EA_AGEDEP,EA_PORTADO,  COUNT(EA_NUM) AS QTD 	 FROM SEA070 EA 	 WHERE EA_DATABOR BETWEEN  '20200901'  AND '20201021' 	 AND EA_TRANSF = ''     AND EA_CART = 'R'     AND D_E_L_E_T_ <> '*' 	 GROUP BY EA_FILIAL, EA_NUMBOR, EA_NUMCON, EA_AGEDEP,EA_PORTADO  
 ) AS PDT  ORDER BY PDT.EMP , PDT.EA_FILIAL, PDT.EA_PORTADO, PDT.EA_NUMCON , PDT.EA_NUMBOR,  PDT.EA_AGEDEP 
 
 SELECT * FROM ZZO010
 
 
 SELECT * FROM SE1010 WHERE E1_BAIXA = '20201007'
 
 SELECT *, RESP_GXML FROM ( 
 SELECT E1_NUM, E1_NUMBOR, E1_FILIAL ,  A3_NOME,  A1_EMAIL, A1_TEL,A1_FAX, E1_NOMCLI, E1_CLIENTE,E1_LOJA , E1_VENCREA FROM SE1020   
INNER JOIN SA3010 ON A3_COD = E1_VEND1
INNER JOIN SA1010 ON A1_COD = E1_CLIENTE AND A1_LOJA = E1_LOJA
WHERE E1_EMISSAO = '20200910'
 AND E1_PORTADO = '389'
 AND E1_NUMBOR IN ('T0EJJQ','U05M43','T0EJJP','S000EU','T0EJJR','M00RTR','M00RTO','T0EJJO','M00RTQ','TST8YW','U05M4B','S52A0B','B10WB7','R003TX','U05M4C','B10WB8','TST8YX','U05M4D','M00RTP')
 ) AS BOLETO
 INNER JOIN SPED050 ON NFE_ID = '1  '+E1_NUM AND DATE_NFE = '20200910' 
 ORDER BY A3_NOME, E1_FILIAL, E1_NUMBOR 



SELECT E1_NUM, E1_NUMBOR, E1_FILIAL ,  A3_NOME,  A1_EMAIL, A1_TEL,A1_FAX, E1_NOMCLI, E1_CLIENTE,E1_LOJA , E1_VENCREA FROM SE1050   
INNER JOIN SA3010 ON A3_COD = E1_VEND1
INNER JOIN SA1010 ON A1_COD = E1_CLIENTE AND A1_LOJA = E1_LOJA
WHERE E1_EMISSAO = '20200910'
 AND E1_PORTADO = '389'
 AND E1_NUMBOR IN ('T0EJJQ','U05M43','T0EJJP','S000EU','T0EJJR','M00RTR','M00RTO','T0EJJO','M00RTQ','TST8YW','U05M4B','S52A0B','B10WB7','R003TX','U05M4C','B10WB8','TST8YX','U05M4D','M00RTP')
 AND D_E_L_E_T_ <> '*'
 ORDER BY A3_NOME, E1_FILIAL, E1_NUMBOR 
 


SELECT * FROM SEA020 WHERE 
EA_NUM = '000171120'

EA_NUMBOR = 'T0EJGA' AND D_E_L_E_T_ <> '*'


SELECT * FROM SE5020 WHERE E5_TIPODOC = 'BA' AND E5_DATA BETWEEN '20200801' AND '20200831'
AND D_E_L_E_T_ <> '*'



SELECT * FROM SPED050 WHERE NFE_ID = '1  000284291'


SELECT * FROM SEA010 WHERE EA_NUM = '000284289'


SELECT * FROM SE1020 WHERE E1_NUMBCO IN (
'006703020063220',
'006703020066246',
'006703020063239' )                                                                                                     
ORDER BY E1_NUMBCO


SELECT * FROM ZZO010 WHERE ZZO_CONTA = '0020362991'


'000171981'
'000171983'
'000171982'
'000171984'
'000172369'
'000172370'


SELECT * FROM SEA010 WHERE EA_NUMBOR = 'R003WE'


SELECT * FROM ZF4010 


SELECT * FROM SE1020 WHERE E1_NUMBCO =  '006703020069822'

sele

'000172799' 'Raissa de Cassia Silva                                      '
'000172800' 'Matheus Borges                                              '
'000172796' 'Raissa de Cassia Silva                                      '
'000172798' 'Matheus Borges                                              '

SELECT RESP_GXML, *
FROM (
SELECT A3_NOME ,E1_FILIAL,E1_NUM ,A1_CGC, E1_CONTA , E1_CONTRAT, E1_PORTADO, E1_VALOR, E1_NOMCLI, E1_EMISSAO, E1_VENCTO, E1_NUMBOR, E1.E1_DATABOR
FROM SE1020 E1
INNER JOIN SA1010 ON A1_COD = E1_CLIENTE AND A1_LOJA = E1_LOJA
INNER JOIN SA3010 ON A1_VEND = A3_COD
WHERE  E1_EMISSAO  > '20200101'
AND E1.D_E_L_E_T_ <> '*'
AND E1_NUM = '000172798'
--AND E1_PORTADO = '389'
--AND E1_BAIXA = ''
--AND E1_VENCTO = '20200706'
--AND A1_CGC = '69666873672'
--AND E1_NUMBOR  = 'T0EJ3J'
--AND E1_FILIAL = '06'
--AND E1_CONTA LIKE '%020362983%'
) AS SEMCAU2
INNER JOIN SPED050 ON '1  '+E1_NUM = NFE_ID  AND DATE_NFE = E1_EMISSAO AND SPED050.D_E_L_E_T_ <> '*'    


SELECT * FROM ZZO010 

SELECT * FROM SB2010  WHERE  B2_COD = '0122' AND B2_FILIAL = '02'




UPDATE SB9010 SET B9_VINI1 = 0, B9_VINI2=0, B9_VINI3=0, B9_VINI4=0, B9_VINI5=0 WHERE B9_COD = '0122' 


SELECT * FROM SB2010 WHERE B2_VFIM1 = 100147051208.369995

SELECT * FROM SE5010 WHERE E5_DATA = '20201005'


SELECT * FROM SE1010 WHERE E1_NUMBCO IN (
'006750010055235  ',
'006750010055227  ',
'006750010055243  ')


'006703020070561',
'006703020072050',
'006703020073234',
'006703020073242')



SELECT * FROM SA1010 WHERE A1_NOME LIKE '%RR COMER%'



SELECT * FROM SE1010 WHERE E1_NUM = '000162706'

SELECT * FROM SE1010 WHERE E1_NUMBCO = '006750010055227  '